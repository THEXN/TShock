<p align="center">
  <img src="https://tshock.s3.us-west-001.backblazeb2.com/newlogo.png" alt="TShock for Terraria"><br />
</p>

- 下载：TShock 的 [官方稳定版和预发布版本](https://github.com/TShock/TShock/releases) 或 [实验版](#experimental-downloads)。  
- 下载：可与 TShock 配合使用的 [插件](https://github.com/Pryaxis/TShock/wiki/Plugins)，以及适用于 OTAPI、TSAPI 和 Terraria 的 [插件](https://github.com/topics/otapi)。  
- 加入 [Discord 服务器](https://discord.gg/Cav9nYX)。  
- 在 [GitHub 讨论区](https://github.com/Pryaxis/TShock/discussions) 交流，可寻求帮助、聊天或其他事宜。如果您不常用 Discord，这是获取帮助的最佳方式。  
- 了解最新动态，请在 Twitter 上关注 [@Pryaxis](https://twitter.com/Pryaxis)。  
- 在 [GitHub](https://github.com/Pryaxis/TShock) 上为项目贡献代码或参与开发。  
- 可获取 [TShock](https://www.nuget.org/packages/TShock/) 和 [TSAPI](https://www.nuget.org/packages/TSAPI/) 的 Nuget 包。
- 如果是中文用户，可加入QQ群：[816771079](https://qm.qq.com/q/kZsJRuS546)

----

## TShock安装指南
如果你需要更详细的中文教程与内容，请访问[TShock 导航指南](https://docs.terraria.ink/zh/other/TShockToolsNav.html)

TShock支持所有.NET 6兼容的系统。你可以在macOS、Windows或Linux的x86、x86_64、arm32、arm64和arm64e架构上运行TShock。借助非官方版本的.NET，TShock也能在FreeBSD上成功运行。

通常情况下，TShock至少需要1GB内存，但使用替代图块提供程序可能会降低最低内存要求。你还需要一台性能较好的计算机。树莓派4可以用于搭建超小型服务器，但实际上，我们建议使用性能更强的设备。

1. 如果你使用Windows 10或其他操作系统，请安装[.NET Runtime 6.x版本](https://dotnet.microsoft.com/en-us/download/dotnet/6.0)；如果你打算构建和开发插件，则需安装.NET SDK 6.x。如果你使用的是Windows 11 22H2或更高版本，可能已经预装了.NET 6。

2. 下载[最新稳定版](https://github.com/TShock/TShock/releases)，然后使用你喜欢的解压缩工具解压文件夹。确保压缩包中的所有文件都解压到同一个文件夹中，这将是你服务器的存储位置。文件结构如下：

          TShock.Server.exe
          bin\
          |------HttpServer.dll
          |------ModFramework.dll
          |------OTAPI.dll
          |------OTAPI.Runtime.dll
          |------TerrariaServer.dll
          ServerPlugins\
          |------TShockAPI.dll

3. 启动`TShock.Server.exe`（在其他平台上，在你选择的终端中输入`./TShock.Server`），TShock将启动并创建一个名为`tshock`的文件夹，用于存储其数据库和配置文件。填写好启动选项后，你就可以开始使用了。在后台，TShock会为你创建一些文件夹，我们稍后会再提到这些文件夹。

4. 启动Terraria。通过IP连接到"多人游戏"服务器，如果你是在本地计算机上操作，请输入`localhost`。如果你是在其他计算机上操作，则需要该计算机的IP地址。

5. 在服务器控制台中查找"_setup code_"。在游戏聊天中输入`/setup [代码]`（例如：`/setup 12345`），然后输入一个空格，然后在游戏聊天框中输入你在控制台看到的代码。这不是普通聊天，而是向服务器发送命令。这个命令会让你成为临时管理员。所有命令都以`/`或`!`（使其静默）为前缀。

6. 使用游戏内命令`/user add [账号名称] [密码] owner`（例如：`/user add shank lovely-grilled-cheese owner`）创建一个账号。这将赋予你服务器的所有者权限，你可以在以后根据自己的喜好进行更多配置。

7. 使用`/login [账号名称] [密码]`（例如：`/login shank grilled-cheese`）登录你新创建的账号。你应该会看到登录成功的消息。

8. 使用`/setup`关闭认证系统，你的服务器就可以开始初始使用了。TShock还会在新的`tshock`文件夹中创建几个文件。这些文件包括`config.json`（我们的主要配置文件）、`sscconfig.json`（服务器端角色配置文件）和`tshock.sqlite`（存放各种内容的数据库）。不要丢失你的`tshock.sqlite`文件，否则你将不得不重新设置TShock。

9. 要安装更多插件，将它们添加到`ServerPlugins`文件夹中。

### 升级指南

要将 TShock 5 升级到更高版本的 TShock 5，只需下载最新版本，解压文件，然后将新版本中的所有文件与你现有安装的文件合并即可。tshock 文件夹包含用户数据，任何数据库变更都会自动执行，以使你的服务器与我们的最新功能保持同步。

#### 从TShock 4升级？

如果你是从TShock 4升级，我们建议下载TShock的新版本，将`tshock`配置文件夹（包含`sqlitedb`文件以及`json`配置文件等）复制到新服务器，然后以这种方式启动新服务器。这是因为TShock 4中的许多文件已被移除，不再需要。此外，你现在需要运行的新二进制文件名为`TShock.Server.exe`或`TShock.Server`，而不是`TerrariaServer.exe`。

此外，在非 Windows 操作系统上，你不再需要安装 `mono-complete` 或 `mono`。这意味着你不能再使用 `mono` 命令启动服务器。在基于 Linux 的操作系统上，要运行新的二进制文件（`TShock.Server`），只需输入 `./TShock.Server`。

### Apple Silicon

在Apple Silicon上，你可以使用Rosetta 2运行TShock。这需要使用TShock及其相关插件的`x64`版本。请确保下载的是该版本。

1. **请勿通过Homebrew安装`dotnet`**，请改为安装适用于x86的[.NET 6 SDK](https://dotnet.microsoft.com/en-us/download)。  
2. 将x64版本的.NET添加到路径中：`export PATH=$PATH:/usr/local/share/dotnet/x64/`。  
3. 若尚未安装Rosetta 2，请在终端中运行：`sudo softwareupdate --install-rosetta --agree-to-license`。  
4. 在终端中运行：`xattr -r -d com.apple.quarantine TShock.Server`，此操作将移除阻止打开TShock的`com.apple.quarantine`隔离标志。  
5. 在终端中运行：`./TShock.Server`。

如果你遇到类似这样的错误：

```
rosetta error: /var/db/oah/2c885558d6a2ecad3098d24447a4071ee679371339e97846cd3d03a3b2bf5ab4/
b45bd88b435cac41689c907440d5761e7182a4da0cbacaea5b1310d4f7e965d0/TShock.Server.aot:
attachment of code signature supplement failed: 1
```

请尝试重启你的Mac、重新下载服务器、安装更新，或重新运行`softwareupdate --install-rosetta`。

由于`W^X`内存保护和其他[MonoMod](https://github.com/MonoMod/MonoMod)尚未支持的功能，TShock需要在Rosetta 2下运行。MonoMod仓库上有一个[关于支持Apple Silicon的问题](https://github.com/MonoMod/MonoMod/issues/90)。

**实验版下载**

要下载 TShock 的实验版本，您有两种选择：AppVeyor 构建版本或 GitHub 构建版本。请注意：TShock 的实验版本是临时发布的，我们不提供技术支持。如果您需要报告问题，请明确说明您下载的构建版本来自哪个提交或分支、使用的服务内容，以及适用的构建编号。

在 [AppVeyor](https://ci.appveyor.com/project/hakusaro/tshock/) 上，点击History（历史记录），找到您想要的构建版本，点击Commit Message（提交信息），然后点击Artifacts（构建产物） 标签页。您可以下载Debug（调试版） 或 Release（发布版）构建。不过，AppVeyor 只保留 6 个月的构建记录，并且有带宽限制。

在 [GitHub](https://github.com/Pryaxis/TShock/) 上，点击Actions（操作），然后在您想要的提交或分支上点击 "CI OTAPI3"。如果构建成功，您可以Artifacts（产物）下载实验发布版或调试版构建包。您必须登录 GitHub 才能使用这些链接。